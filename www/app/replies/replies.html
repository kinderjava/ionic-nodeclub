<ion-view>
  <ion-nav-title on-hold="doRefresh()">最新回复</ion-nav-title>
  <ion-nav-buttons side="right">
    <button class="button header-replies-button"
            ng-click="scrollDelegate.scrollBottom(true)"
            on-hold="doRefresh()"
            ng-if="displayReplies">
      {{::topic.replies.length}}回复
    </button>
  </ion-nav-buttons>
  <ion-content delegate-handle="replies-handle"
               overflow-scroll="true">
    <!--<ion-refresher pulling-text="下拉刷新..."-->
                   <!--pulling-icon="ion-ios-arrow-down"-->
                   <!--spinner="spiral"-->
                   <!--on-refresh="doRefresh()">-->
    <!--</ion-refresher>-->
    <div class="text-center padding"
         ng-if="loading">
      <ion-spinner icon="spiral"></ion-spinner>
      <p>加载中...</p>
    </div>
    <div class="padding text-center"
         ng-if="error">
      囧，出错啦...
    </div>
    <div class="list" ng-if="topic">
      <div class="item item-divider item-text-wrap">
        <a ui-sref="app.topic({topicId: topic.id})"
           class="button-link dark">{{::topic.title}}</a>
      </div>
      <div class="item"
           ng-if="!displayReplies.length && !loading && !error">
        暂无回复
      </div>
      <div ng-if="hotReplies.length"
           class="item item-divider assertive">热门评论</div>
      <reply-tile ng-repeat="reply in hotReplies track by reply.id"
                  reply="::reply"></reply-tile>
      <div ng-if="hotReplies.length"
           class="item item-divider positive">最新评论</div>
      <reply-tile ng-repeat="reply in displayReplies track by reply.id"
                  reply="::reply"></reply-tile>
      <div class="item"
           ng-if="displayReplies.length < topic.replies.length">
        <button class="button button-small button-block button-stable"
                ng-click="displayAll()">
          显示全部
        </button>
      </div>
    </div>
  </ion-content>
  <elastic-footer>
    <label class="new-reply item-input-wrapper">
      <textarea msd-elastic
                focus-on="focus.newReplyInput"
                ng-model="newReply.content"
                ng-change="!newReply.content&&clearNewReply()"
                placeholder="添加回复">
      </textarea>
    </label>
    <button class="button button-link reply-button"
            ng-disabled="!newReply.content"
            ng-click="sendReply()"
            on-hold="showSendAction()">发送</button>
  </elastic-footer>
</ion-view>
